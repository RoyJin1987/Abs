<!DOCTYPE html>  
<html>  
<head>  
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<style type="text/css">
		body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;}
		#golist {display: none;}
		@media (max-device-width: 780px){#golist{display: block !important;}}
	</style>
	<title>html app</title>
	<link href="css/buttons.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="css/jquery.mobile.flatui.css" />
	<link href="css/main.css" rel="stylesheet" type="text/css">
	<script src="js/jquery.js"></script>
	<script src="js/jquery.mobile-1.4.0-rc.1.js"></script> 
	<script src="js/common.js"></script>
	<style type="text/css">
    .ui-listview.ui-icon-arrow-r {
    background: transparent url(images/arrow_right.png) center center no-repeat !important;
    -webkit-border-radius: 0;
    -moz-border-radius: 0;
    border-radius: 0;}
    </style>
	<script >  
		/**  
		这里为listview的ul标签事先设置一个模板，然后与后台的数据key相对应  
		*/  
		$(function(){  
			var jsonStr = '{"Action":"OrderItems","status":0,"Token":"07b27a882cc721a9207250f1b6bd2868"}';
			var url = "http://112.124.122.107/Applications/web/?data=" + jsonStr;
			
			showList(url);
			  
		});  
		
		function showList(url){
			var innerHtml = "";
			var viewObj=$("#messageList");  

			/*2、循环遍历数据，并克隆模板，将数据插入到模板dbField相对应的节点中，然后增加到listview上*/  
			// for(var i=0; i<5; i++){  
			// 	var messageId= 1;
				
			// 	innerHtml=innerHtml
			// 	+"<li style=list-style:none;background:none;><a href='' messageId='"+messageId+"'><h2>加入车队</h2><p>XXX邀请您加入他的车队</p></a></li>";
			// }  
			
			// viewObj.append(innerHtml);
			//3、刷新 以上二种都可以刷新数据  
			viewObj.listview("refresh");  
		}
		
		var ordersInfo = {
			id: null,
			items: null
		}
			
		function urnAction(obj){
			var jsonStr = '{"Action":"OrderItems","status":0,"Token":"07b27a882cc721a9207250f1b6bd2868"}';
			var viewObj=$("#pushOrderList");  
			if (obj.id=="btn_cancel"){
				jsonStr = '{"Action":"OrderItems","status":1,"Token":"07b27a882cc721a9207250f1b6bd2868"}';
				viewObj=$("#canceledOrderList");  
			}else if (obj.id=="btn_confirm"){
				jsonStr = '{"Action":"OrderItems","status":2,"Token":"07b27a882cc721a9207250f1b6bd2868"}';
				viewObj=$("#confirmedOrderList");  
			}else if (obj.id=="btn_completed"){
				jsonStr = '{"Action":"OrderItems","status":3,"Token":"07b27a882cc721a9207250f1b6bd2868"}';
				viewObj=$("#completedOrderList");  
			}
			var url = "http://112.124.122.107/Applications/web/?data=" + jsonStr;
			showList(url,viewObj);
		}
		
		$(document).on('vclick', '#pushOrderList li a', function () {
		        ordersInfo.id = $(this).attr('orderId');
		        $.mobile.changePage("#pushDetail", { transition: "slide", changeHash: false });
				
		    });
			
			$(document).on('pagebeforeshow', '#pushDetail', function () {
		        $.each(ordersInfo.items, function (i, row) {
		            if (row.orderId == ordersInfo.id) {
					
		                for(var key in row){  
                            $("[dbField='"+key+"']").html(row[key]);  
                        }       
						$("[dbField='send_city_address']").html(row.send_address.city + row.send_address.address);
						$("[dbField='shipping_city_address']").html(row.shipping_address.city + row.shipping_address.address);
		            }
		        });
		    });
        </script>  
</head>  
<body>  
	<div data-role="page" id="messageCenter" >  
		<div data-role="header" data-position="fixed" data-theme="f">
			<a data-iconpos="myleft" data-rel="back" data-role="button" data-icon="myback" title="Home"  data-direction="reverse">返回</a>
			<h1>消息中心</h1>
			<a href="#" data-role="button" data-iconpos="notext" data-icon="search"></a>
		</div>
		<div class="uilist" data-role="content">
			<ul data-role='listview' data-inset="true" id="messageList" class="ui-listview" data-theme="c">  
				<li style="list-style:none;background:none;">
					<a href='' messageId='dsfad'>
						<h2>加入车队</h2>
						<p>XXX邀请您加入他的车队</p></a></li>
            </ul>  
		</div>
	</div>
</body>  
</html>


